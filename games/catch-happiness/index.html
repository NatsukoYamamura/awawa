<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>ğŸŒ¸ æ¥ä½å°ç¡®å¹¸ - awa.wang</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --primary: #ffb7c5;
      --text: #5a4a66;
      --bg: linear-gradient(135deg, #fff5f7 0%, #f0f9ff 100%);
    }

    body {
      font-family: 'Segoe UI', 'PingFang SC', sans-serif;
      background: var(--bg);
      min-height: 100vh;
      overflow: hidden;
      touch-action: none;
      user-select: none;
    }

    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: 15px 20px;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 100;
      box-shadow: 0 2px 20px rgba(180,120,200,0.15);
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      background: rgba(255,183,197,0.2);
      border: 2px solid var(--primary);
      border-radius: 50px;
      color: var(--text);
      text-decoration: none;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.3s;
    }

    .back-btn:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-2px);
    }

    .score-board {
      display: flex;
      gap: 15px;
      font-weight: 700;
      color: var(--text);
    }

    .score-item {
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      padding: 8px 16px;
      border-radius: 20px;
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    #gameArea {
      position: relative;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }

    .basket {
      position: absolute;
      bottom: 80px;
      width: 100px;
      height: 60px;
      background: linear-gradient(135deg, #a1c4fd, #a18cd1);
      border-radius: 0 0 50px 50px;
      box-shadow: 0 8px 20px rgba(161,196,253,0.4);
      transition: left 0.1s ease-out;
      z-index: 50;
    }

    .basket::before {
      content: 'ğŸ§º';
      position: absolute;
      top: -35px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
    }

    .falling-item {
      position: absolute;
      font-size: 2.5rem;
      animation: fall linear forwards;
      z-index: 40;
    }

    @keyframes fall {
      from { transform: translateY(-50px) rotate(0deg); }
      to { transform: translateY(110vh) rotate(360deg); }
    }

    .catch-effect {
      position: absolute;
      font-size: 2rem;
      font-weight: 800;
      color: #ff9a9e;
      animation: float-up-score 0.8s ease-out forwards;
      z-index: 60;
      text-shadow: 0 2px 10px rgba(255,154,158,0.5);
    }

    @keyframes float-up-score {
      from { transform: translateY(0) scale(1); opacity: 1; }
      to { transform: translateY(-80px) scale(1.3); opacity: 0; }
    }

    .controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 15px;
      z-index: 100;
    }

    .btn {
      padding: 12px 28px;
      border: none;
      border-radius: 50px;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }

    .btn-primary {
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      color: white;
    }

    .btn-secondary {
      background: rgba(255,255,255,0.9);
      color: var(--text);
      border: 2px solid var(--primary);
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }

    .game-over {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 200;
      backdrop-filter: blur(5px);
    }

    .game-over.show { display: flex; }

    .game-over-content {
      background: white;
      padding: 40px 60px;
      border-radius: 30px;
      text-align: center;
      animation: pop-in 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
    }

    @keyframes pop-in {
      from { transform: scale(0.5); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .game-over h2 {
      font-size: 2rem;
      color: var(--text);
      margin-bottom: 10px;
    }

    .game-over .final-score {
      font-size: 3rem;
      font-weight: 800;
      background: linear-gradient(135deg, #ff9a9e, #a1c4fd);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 20px 0;
    }

    .bg-particle {
      position: fixed;
      pointer-events: none;
      z-index: -1;
      opacity: 0.6;
    }

    .mobile-hint {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255,255,255,0.9);
      padding: 10px 20px;
      border-radius: 50px;
      color: var(--text);
      font-size: 0.9rem;
      z-index: 90;
      animation: fade-out 3s 2s forwards;
    }

    @keyframes fade-out { to { opacity: 0; } }

    @media (max-width: 600px) {
      .basket { width: 80px; height: 50px; }
      .basket::before { font-size: 2.5rem; top: -30px; }
      .game-over-content { padding: 30px 40px; margin: 20px; }
      .falling-item { font-size: 2rem; }
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <div class="basket" id="basket"></div>
  </div>

  <div class="mobile-hint" id="mobileHint">ğŸ‘† æ»‘åŠ¨æˆ–ç‚¹å‡»å±å¹•å·¦å³ç§»åŠ¨ç¯®å­ï½</div>

  <div class="header">
    <a href="/games" class="back-btn">â† è¿”å›</a>
    <div class="score-board">
      <div class="score-item">ğŸŒ¸ åˆ†æ•°ï¼š<span id="score">0</span></div>
      <div class="score-item">ğŸ’– ç”Ÿå‘½ï¼š<span id="lives">5</span></div>
    </div>
  </div>

  <div class="controls">
    <button class="btn btn-secondary" onclick="resetGame()">ğŸ”„ é‡ç½®</button>
    <button class="btn btn-primary" onclick="togglePause()" id="pauseBtn">â¸ï¸ æš‚åœ</button>
  </div>

  <div class="game-over" id="gameOver">
    <div class="game-over-content">
      <h2>ğŸ® æ¸¸æˆç»“æŸ</h2>
      <div class="final-score" id="finalScore">0</div>
      <p id="finalMessage">å°ç¡®å¹¸è¿˜åœ¨ç­‰ä½ å“¦ï½</p>
      <button class="btn btn-primary" onclick="resetGame(); document.getElementById('gameOver').classList.remove('show')">ğŸŒ¸ å†æ¥ä¸€å±€</button>
    </div>
  </div>

  <script>
    // ========== é…ç½® ==========
    const ITEMS = [
      { emoji: 'ğŸŒ¸', points: 10, weight: 3 },
      { emoji: 'â­', points: 20, weight: 2 },
      { emoji: 'ğŸ¬', points: 15, weight: 3 },
      { emoji: 'ğŸŸ', points: 25, weight: 1 },
      { emoji: 'ğŸ’–', points: 30, weight: 1 },
      { emoji: 'ğŸ«§', points: 15, weight: 3 },
      { emoji: 'ğŸ€', points: 20, weight: 2 },
      { emoji: 'ğŸ€', points: 35, weight: 1 }
    ];

    const BAD_ITEMS = [
      { emoji: 'ğŸŒµ', points: -20, weight: 1 },
      { emoji: 'ğŸ’£', points: -30, weight: 1 }
    ];

    // ========== å˜é‡ ==========
    let score = 0;
    let lives = 5;
    let isPaused = false;
    let isGameOver = false;
    let basketX = 50;
    let fallingItems = [];
    let spawnInterval;
    let gameSpeed = 2;
    let gameArea, basket;

    // ========== åˆå§‹åŒ– ==========
    function init() {
      gameArea = document.getElementById('gameArea');
      basket = document.getElementById('basket');
      
      updateBasketPosition();
      
      // é”®ç›˜æ§åˆ¶
      document.addEventListener('keydown', handleKeydown);
      
      // è§¦æ§/é¼ æ ‡æ§åˆ¶
      gameArea.addEventListener('touchmove', handleTouch, { passive: false });
      gameArea.addEventListener('mousemove', handleMouse);
      gameArea.addEventListener('click', handleClick);
      
      startGame();
      createBgParticles();
    }

    function handleKeydown(e) {
      if (isPaused || isGameOver) return;
      
      const step = 8;
      if (e.key === 'ArrowLeft' || e.key === 'a') {
        basketX = Math.max(5, basketX - step);
      } else if (e.key === 'ArrowRight' || e.key === 'd') {
        basketX = Math.min(95, basketX + step);
      }
      updateBasketPosition();
    }

    function handleTouch(e) {
      e.preventDefault();
      if (isPaused || isGameOver) return;
      
      const touch = e.touches[0];
      const percent = (touch.clientX / window.innerWidth) * 100;
      basketX = Math.max(5, Math.min(95, percent));
      updateBasketPosition();
    }

    function handleMouse(e) {
      if (isPaused || isGameOver) return;
      if (e.buttons !== 1) return; // åªå“åº”é¼ æ ‡æŒ‰ä¸‹æ—¶
      
      const percent = (e.clientX / window.innerWidth) * 100;
      basketX = Math.max(5, Math.min(95, percent));
      updateBasketPosition();
    }

    function handleClick(e) {
      if (isPaused || isGameOver) return;
      
      const percent = (e.clientX / window.innerWidth) * 100;
      basketX = Math.max(5, Math.min(95, percent));
      updateBasketPosition();
    }

    function updateBasketPosition() {
      basket.style.left = `${basketX}%`;
      basket.style.transform = 'translateX(-50%)';
    }

    function startGame() {
      spawnInterval = setInterval(spawnItem, 800);
      gameLoop();
    }

    function spawnItem() {
      if (isPaused || isGameOver) return;
      
      const rand = Math.random();
      let itemData;
      
      // 80% å¥½ç‰©å“ï¼Œ20% åç‰©å“
      if (rand < 0.8) {
        const totalWeight = ITEMS.reduce((sum, item) => sum + item.weight, 0);
        let weightedRand = Math.random() * totalWeight;
        for (const item of ITEMS) {
          weightedRand -= item.weight;
          if (weightedRand <= 0) {
            itemData = item;
            break;
          }
        }
      } else {
        itemData = BAD_ITEMS[Math.floor(Math.random() * BAD_ITEMS.length)];
      }
      
      const item = document.createElement('div');
      item.className = 'falling-item';
      item.textContent = itemData.emoji;
      item.style.left = `${Math.random() * 85 + 5}%`;
      item.style.animationDuration = `${Math.random() * 2 + 3}s`;
      
      gameArea.appendChild(item);
      
      fallingItems.push({
        element: item,
        data: itemData,
        y: -50,
        x: parseFloat(item.style.left)
      });
    }

    function gameLoop() {
      if (!isPaused && !isGameOver) {
        const basketRect = basket.getBoundingClientRect();
        const basketLeft = basketRect.left;
        const basketRight = basketRect.right;
        const basketTop = basketRect.top;
        
        fallingItems = fallingItems.filter(item => {
          item.y += gameSpeed;
          item.element.style.top = `${item.y}px`;
          
          const itemRect = item.element.getBoundingClientRect();
          
          // æ£€æŸ¥æ˜¯å¦æ¥ä½
          if (item.y + itemRect.height >= basketTop && 
              item.y <= basketTop + 20 &&
              itemRect.left + itemRect.width / 2 >= basketLeft &&
              itemRect.right - itemRect.width / 2 <= basketRight) {
            
            // æ¥ä½äº†ï¼
            score += item.data.points;
            if (score < 0) score = 0;
            updateScore();
            showCatchEffect(item.x, item.data.points);
            playSound(item.data.points > 0 ? 'catch' : 'bad');
            item.element.remove();
            return false;
          }
          
          // æ£€æŸ¥æ˜¯å¦è½åœ°
          if (item.y > window.innerHeight) {
            if (item.data.points > 0) {
              lives--;
              updateLives();
              playSound('miss');
              if (lives <= 0) {
                gameOver();
              }
            }
            item.element.remove();
            return false;
          }
          
          return true;
        });
        
        // éš¾åº¦é€’å¢
        gameSpeed = 2 + Math.floor(score / 100) * 0.5;
      }
      
      requestAnimationFrame(gameLoop);
    }

    function showCatchEffect(x, points) {
      const effect = document.createElement('div');
      effect.className = 'catch-effect';
      effect.textContent = points > 0 ? `+${points}` : points;
      effect.style.left = `${x}%`;
      effect.style.bottom = '120px';
      gameArea.appendChild(effect);
      setTimeout(() => effect.remove(), 800);
    }

    function updateScore() {
      document.getElementById('score').textContent = score;
    }

    function updateLives() {
      document.getElementById('lives').textContent = 'ğŸ’–'.repeat(lives);
    }

    function gameOver() {
      isGameOver = true;
      clearInterval(spawnInterval);
      
      document.getElementById('finalScore').textContent = score;
      
      let message = 'å°ç¡®å¹¸è¿˜åœ¨ç­‰ä½ å“¦ï½';
      if (score >= 200) message = 'âœ¨ æ¥ä½å¥½å¤šå¹¸ç¦ï¼å¥½æ£’ï½';
      if (score >= 500) message = 'ğŸ† å¹¸ç¦æ•æ‰‹ï¼å¤ªå‰å®³äº†ï¼';
      if (score >= 1000) message = 'ğŸ‘‘ ä¼ è¯´çº§å¹¸è¿å„¿ï¼awa ç¾¡æ…•äº†ï¼';
      
      document.getElementById('finalMessage').textContent = message;
      document.getElementById('gameOver').classList.add('show');
    }

    function resetGame() {
      score = 0;
      lives = 5;
      isGameOver = false;
      isPaused = false;
      gameSpeed = 2;
      document.getElementById('pauseBtn').textContent = 'â¸ï¸ æš‚åœ';
      document.getElementById('gameOver').classList.remove('show');
      
      // æ¸…é™¤æ‰€æœ‰æ‰è½ç‰©
      fallingItems.forEach(item => item.element.remove());
      fallingItems = [];
      
      updateScore();
      updateLives();
      
      clearInterval(spawnInterval);
      startGame();
    }

    function togglePause() {
      isPaused = !isPaused;
      document.getElementById('pauseBtn').textContent = isPaused ? 'â–¶ï¸ ç»§ç»­' : 'â¸ï¸ æš‚åœ';
    }

    function playSound(type) {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      if (type === 'catch') {
        oscillator.frequency.value = 500 + Math.random() * 300;
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.15);
      } else if (type === 'bad') {
        oscillator.frequency.value = 200;
        oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.2);
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.2);
      } else if (type === 'miss') {
        oscillator.frequency.value = 300;
        gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
      }
    }

    function createBgParticles() {
      const particles = ['ğŸŒ¸', 'â­', 'ğŸ«§', 'ğŸ’–', 'ğŸ¬'];
      for (let i = 0; i < 20; i++) {
        setTimeout(() => {
          const p = document.createElement('div');
          p.className = 'bg-particle';
          p.textContent = particles[Math.floor(Math.random() * particles.length)];
          p.style.left = `${Math.random() * 100}%`;
          p.style.top = `${Math.random() * 100}%`;
          p.style.fontSize = `${Math.random() * 20 + 15}px`;
          p.style.animation = `float-up ${Math.random() * 20 + 15}s linear infinite`;
          document.body.appendChild(p);
          
          setTimeout(() => p.remove(), 20000);
        }, i * 500);
      }
    }

    // å¯åŠ¨
    init();
  </script>
</body>
</html>